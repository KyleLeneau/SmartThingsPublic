machine:
  java:
    version:
      oraclejdk8

dependencies:
  override:
    - ./gradlew dependencies
  post:
    - ./gradlew compileSmartappsGroovy compileDevicetypesGroovy

test:
  override:
    - echo "We don't have any tests :-("

deployment:
  develop:
    branch: master
    commands:
      - ./gradlew deployArchives -Ps3Buckets="$S3_BUCKETS_DEV"
      - ./gradlew slackSendMessage -Pbranch="$CIRCLE_BRANCH" -PslackToken="$SLACK_TOKEN" -PslackWebhookUrl="$SLACK_WEBHOOK_URL" -PslackChannel="$SLACK_CHANNEL" --stacktrace

  stage:
    branch: staging
    commands:
      - ./gradlew deployArchives -Ps3Buckets="$S3_BUCKETS_STAGE"
      - ./gradlew slackSendMessage -Pbranch="$CIRCLE_BRANCH" -PslackToken="$SLACK_TOKEN" -PslackWebhookUrl="$SLACK_WEBHOOK_URL" -PslackChannel="$SLACK_CHANNEL" --stacktrace
